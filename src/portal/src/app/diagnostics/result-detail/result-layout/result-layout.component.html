<div class="title main">
  <!-- <i class="material-icons" [ngClass]="result.state">{{stateIcon(result.state)}}</i> -->
  <div class="name">{{result.id}} - {{result.name}} {{result.state}}</div>
  <app-back-button></app-back-button>
</div>
<div class="area-title">
  <i class="material-icons title-icon">equalizer</i>
  <div>OVERVIEW</div>
</div>

<div class="error-message" *ngIf="result.aggregationResult != undefined && result.aggregationResult.Error != undefined;else jobOverview">
  {{result.aggregationResult.Error}}
</div>
<ng-template #jobOverview>
  <mat-tab-group>
    <mat-tab label="Latency">
      <div class="overview-header">
        <div class="chart-type">
          <div class="chart-btn" [class.active]="activeLatencyMode == 'total'" (click)="setLatencyActiveMode('total')">Total</div>
          <div class="chart-btn" [class.active]="activeLatencyMode == 'node'" (click)="setLatencyActiveMode('node')">By Node</div>
        </div>
        <div class="select-node" *ngIf="activeLatencyMode == 'node'">
          <mat-form-field>
            <mat-select placeholder="Select Node" [(ngModel)]="selectedNode" (selectionChange)="changeLatencyNode()">
              <mat-option *ngFor="let node of nodes" [value]="node" style="font-size: .9em;">
                {{ node }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <div class="overview-chart">
        <chart type="horizontalBar" class="col-lg-4" [data]="latencyData" [options]="latencyOption">
        </chart>

        <div class="result-detail col-lg-2">
          <div class="overview-info">
            <div class="overview-title"> Passed </div>
            <div>
              <i class="material-icons passed" *ngIf="latencyPassed == true">done</i>
              <i class="material-icons not-passed" *ngIf="latencyPassed == false">clear</i>
              <!-- {{latencyPassed}} -->
            </div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Packet Size </div>
            <div class="overview-value">{{latencyPacketSize}}</div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Average </div>
            <div class="overview-value">{{latencyAverage | number: '1.2-2'}} us</div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Median </div>
            <div class="overview-value">{{latencyMedian | number: '1.2-2'}} us</div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Standard Deviation </div>
            <div class="overview-value">{{latencyStandardDeviation | number: '1.2-2'}} us</div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Variability </div>
            <div class="overview-value">{{latencyVariability}}</div>
          </div>
        </div>

        <div class="result-pair col-lg-4">
          <div class="overview-info">
            <div class="overview-title"> Best Pairs </div>
            <div class="pair-list" *ngFor="let p of latencyBestPairs">
              <div>{{p}}</div>
              <div>{{latencyBestPairsValue | number: '1.2-2'}} us</div>
            </div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Worst Pairs </div>
            <div class="pair-list" *ngFor="let p of latencyWorstPairs">
              <div>{{p}}</div>
              <div>{{latencyWorstPairsValue | number: '1.2-2'}} us</div>
            </div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Bad Pairs </div>
            <div class="pair-list" *ngFor="let p of latencyBadPairs">
              <div>{{p.Pair}}</div>
              <div>{{p.Value | number: '1.2-2'}} us</div>
            </div>
          </div>
        </div>
      </div>
    </mat-tab>
    <mat-tab label="Throughput">
      <div class="overview-header">
        <div class="chart-type">
          <div class="chart-btn" [class.active]="activeThroughputMode == 'total'" (click)="setThroughputActiveMode('total')">Total</div>
          <div class="chart-btn" [class.active]="activeThroughputMode == 'node'" (click)="setThroughputActiveMode('node')">By Node</div>
        </div>
        <div class="select-node" *ngIf="activeThroughputMode == 'node'">
          <mat-form-field>
            <mat-select placeholder="Select Node" [(ngModel)]="selectedNode" (selectionChange)="changeThroughputNode()">
              <mat-option *ngFor="let node of nodes" [value]="node" style="font-size: .9em;">
                {{ node }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <div class="overview-chart">
        <chart type="horizontalBar" class="col-lg-4" [data]="throughputData" [options]="throughputOption">
        </chart>

        <div class="result-detail col-lg-2">
          <div class="overview-info">
            <div class="overview-title"> Passed </div>
            <i class="material-icons passed" *ngIf="throughputPassed == true">done</i>
            <i class="material-icons not-passed" *ngIf="throughputPassed == false">clear</i>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Packet Size </div>
            <div class="overview-value">{{throughputPacketSize}}</div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Average </div>
            <div class="overview-value">{{throughputAverage | number: '1.2-2'}} us</div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Median </div>
            <div class="overview-value">{{throughputMedian | number: '1.2-2'}} us</div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Standard Deviation </div>
            <div class="overview-value">{{throughputStandardDeviation | number: '1.2-2'}} us</div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Variability </div>
            <div class="overview-value">{{throughputVariability}}</div>
          </div>
        </div>

        <div class="result-pair col-lg-5">
          <div class="overview-info">
            <div class="overview-title"> Best Pairs </div>
            <div class="pair-list" *ngFor="let p of throughputBestPairs">
              <div>{{p}}</div>
              <div>{{throughputBestPairsValue | number: '1.2-2'}} us</div>
            </div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Worst Pairs </div>
            <div class="pair-list" *ngFor="let p of throughputWorstPairs">
              <div>{{p}}</div>
              <div>{{throughputWorstPairsValue | number: '1.2-2'}} us</div>
            </div>
          </div>
          <div class="overview-info">
            <div class="overview-title"> Bad Pairs </div>
            <div class="pair-list" *ngFor="let p of throughputBadPairs">
              <div>{{p.Pair}}</div>
              <div>{{p.Value | number: '1.2-2'}} us</div>
            </div>
          </div>
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>
</ng-template>
<!-- <div class="task-result-info">
  <div class="aggregationResult">
    {{result.aggregationResult}}
  </div>
  <chart type="doughnut" [data]="overviewData" [options]="overviewOption"></chart>
</div> -->

<div class="area-title">
  <i class="material-icons title-icon">widgets</i>
  <div>TASKS</div>
</div>
<div class="nodes">
  <ng-container *ngTemplateOutlet="nodesTemplate; context: result"></ng-container>
</div>