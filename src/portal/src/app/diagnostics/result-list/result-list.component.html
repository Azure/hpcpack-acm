<div class="actions">
  <button mat-raised-button (click)="customizeTable()" class="icon-btn">
    <div class="action-btn">
      <i class="material-icons btn-icon">settings</i>
      <div>Customize Columns...</div>
    </div>
  </button>
</div>

<div class="list-container">
  <div class="list-header">
    <div class="job-id" [ngStyle]="getColumnOrder('id')">
      ID
    </div>
    <div class="job-created" [ngStyle]="getColumnOrder('createdAt')">
      Created
    </div>
    <div class="job-test" [ngStyle]="getColumnOrder('test')">
      Test Name
    </div>
    <div class="job-diagnostic" [ngStyle]="getColumnOrder('diagnostic')">
      Diagnostic
    </div>
    <div class="job-category" [ngStyle]="getColumnOrder('category')">
      Category
    </div>
    <div class="job-state" [ngStyle]="getColumnOrder('state')">
      State
    </div>
    <div class="job-progress" [ngStyle]="getColumnOrder('progress')">
      Progress
    </div>
    <div class="job-updated" [ngStyle]="getColumnOrder('updatedAt')">
      Last Changed
    </div>
  </div>
  <div class="list-content">
    <cdk-virtual-scroll-viewport itemSize="20" #content class="list-content" (scrolledIndexChange)="indexChanged($event)">
      <div *cdkVirtualFor="let job of dataSource; templateCacheSize: 0; trackBy: trackByFn.bind(this)" class="list-item">
        <div class="icon-cell job-id" [ngStyle]="getColumnOrder('id')">
          <i class="material-icons cell-icon color-icon">local_hospital</i>
          <a [routerLink]="job.id" class="cell-text">{{job.id}}</a>
        </div>

        <div class="icon-cell job-created" [ngStyle]="getColumnOrder('createdAt')">
          <i class="material-icons cell-icon">access_time</i>
          <div class="cell-text">{{job.createdAt | date:'yyyy-MM-dd HH:mm:ss'}}</div>
        </div>

        <div class="icon-cell job-test" [ngStyle]="getColumnOrder('test')">
          {{job.name}}
        </div>

        <div class="icon-cell job-diagnostic" [ngStyle]="getColumnOrder('diagnostic')">
          {{job.diagnosticTest.name}}
        </div>

        <div class="icon-cell job-category" [ngStyle]="getColumnOrder('category')">
          {{job.diagnosticTest.category}}
        </div>

        <div class="icon-cell job-state" [ngStyle]="getColumnOrder('state')">
          <i class="material-icons cell-icon" [ngClass]="stateClass(job.state)">{{stateIcon(job.state)}}</i>
          <div class="cell-text">{{job.state | titlecase}}</div>
        </div>

        <div class="table-progress job-progress" [ngStyle]="getColumnOrder('progress')">
          <mat-progress-bar mode="determinate" [value]="job.progress * 100"></mat-progress-bar>
          <div class="progress-num"> {{job.progress | percent}} </div>
        </div>

        <div class="icon-cell job-updated" [ngStyle]="getColumnOrder('updatedAt')">
          <i class="material-icons cell-icon">access_alarm</i>
          <div class="cell-text"> {{job.updatedAt | date:'yyyy-MM-dd HH:mm:ss'}} </div>
        </div>
      </div>
    </cdk-virtual-scroll-viewport>

    <app-scroll-to-top [scrolled]="scrolled" [targetEle]="content"></app-scroll-to-top>

    <div class="loading" *ngIf="empty">
      <mat-spinner></mat-spinner>
    </div>
  </div>
</div>

<app-loading-progress-bar [loadFinished]="loadFinished" *ngIf="loading" class="virtual-scroll-loading"></app-loading-progress-bar>
